<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Code Injection</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      line-height: 1.6;
      background: #f4f4f4 url('cloud.jpg') no-repeat top center;
      background-size: cover;
      margin: 0;
      padding: 0;
    }
    .container {
      max-width: 900px;
      margin: 80px auto;
      background: rgba(255, 255, 255, 0.95);
      padding: 30px;
      border-radius: 12px;
      box-shadow: 0 8px 30px rgba(0,0,0,0.1);
    }
    h1, h2, h3 {
      color: #222;
    }
    pre {
      background: #eee;
      padding: 10px;
      border-radius: 6px;
      overflow-x: auto;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin: 20px 0;
    }
    table, th, td {
      border: 1px solid #ccc;
    }
    th, td {
      padding: 10px;
      text-align: left;
    }
    th {
      background-color: #f0f0f0;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Code Injection</h1>
    <p>Injecting malicious code into the application so it gets executed. Code injection typically compromises the application but may not directly affect the entire system.</p>
    
    <h2>Target</h2>
    <p>The application's runtime environment (e.g., Python, PHP, Java, JavaScript).</p>
    
    <h2>Effect</h2>
    <p>Runs in the context of the application itself.</p>

    <h2>Example in Python (Unsafe)</h2>
    <pre>
user = input("Enter the first number: ")
user1 = input("Enter the second number: ")

evaluated = eval(user) + eval(user1)
print(evaluated)
    </pre>
    <p>Example Input:</p>
    <pre>
Enter the first number: 10
Enter the second number: 15
Output: 25
    </pre>

    <h2>Malicious Input</h2>
    <pre>
Enter the first number: __import__('os').system('rm -rf /')
Enter the second number:
    </pre>
    <p>This could delete all files on the system.</p>

    <h2>Safe Alternative in Python</h2>
    <pre>
import ast

user = ast.literal_eval(input("Enter the first number: "))
user1 = ast.literal_eval(input("Enter the second number: "))

print(user + user1)
    </pre>

    <h2>Understanding eval() vs exec()</h2>
    <p><strong>eval(expr)</strong>: Evaluates a single expression and returns a value.</p>
    <pre>eval("2 + 3")   # returns 5</pre>
    <p><strong>exec(code)</strong>: Executes any block of Python code (statements, functions, imports, loops) and returns nothing.</p>
    <pre>exec("for i in range(3): print(i)")   # prints 0 1 2</pre>

    <h2>Attacker Perspective</h2>
    <p>Need to know the language and application context to craft malicious code. Can manipulate variables, import modules, access memory, override functions, and execute arbitrary Python code.</p>

    <h2>Difference Between Code Injection and Command Injection</h2>
    <table>
      <tr>
        <th>Factor</th>
        <th>Command Injection</th>
        <th>Code Injection</th>
      </tr>
      <tr>
        <td>Target</td>
        <td>OS commands</td>
        <td>Application logic + sometimes OS</td>
      </tr>
      <tr>
        <td>Access</td>
        <td>App internals: None</td>
        <td>Full access to variables, memory, functions</td>
      </tr>
      <tr>
        <td>Potential Impact</td>
        <td>High (files, network)</td>
        <td>Very High (app logic, secrets, system)</td>
      </tr>
      <tr>
        <td>Exploit Complexity</td>
        <td>Usually easier</td>
        <td>Can require knowledge of app structure</td>
      </tr>
      <tr>
        <td>Privileges</td>
        <td>OS-level</td>
        <td>App-level (may escalate)</td>
      </tr>
    </table>

    <h2>Defender Perspective</h2>
    <ul>
      <li>Never trust user input.</li>
      <li>Input validation: Allow only expected types or patterns.</li>
      <li>Input sanitization: Remove or neutralize unsafe characters or code.</li>
      <li>Avoid dynamic code execution functions: eval(), exec(), Function().</li>
      <li>Contextual encoding: HTML, JS, SQL encoding to prevent injection.</li>
      <li>Use parameterized queries instead of string concatenation in databases.</li>
      <li>Use Base64 or URL encoding where appropriate.</li>
    </ul>
  </div>
</body>
</html>
