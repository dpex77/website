<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CSRF</title>
<style>
body {
    font-family: Arial, sans-serif;
    background: #f4f4f4 url('cloud.jpg') no-repeat top center;
    background-size: cover;
    padding: 20px;
    color: #111;
}

.card {
    background: white;
    border-radius: 12px;
    box-shadow: 0 8px 30px rgba(11,26,43,0.08);
    padding: 20px;
    margin-bottom: 20px;
    white-space: pre-wrap;
}

h2 {
    margin-top: 0;
}

code {
    background-color: #eee;
    padding: 2px 4px;
    border-radius: 4px;
}
</style>
</head>
<body>

<div class="card">
<h2>1. Overview:</h2>
CSRF (Cross-Site Request Forgery) occurs when an authenticated user is tricked into performing actions on a site where they are logged in, without their knowledge.  
The attacker does not need the userâ€™s password.  
CSRF exploits the fact that the server trusts requests from the authenticated client.
</div>

<div class="card">
<h2>2. Vulnerability from an Attacker Perspective:</h2>
- Active session: The user is already logged in; the browser automatically sends authentication cookies.  
- Same-Origin Policy (SOP) limitation: Browsers prevent scripts from reading data across origins, but they still send cookies with legitimate requests to the target domain.
</div>

<div class="card">
<h2>2.1 Attempts of an Attacker:</h2>
- Tricking the user into clicking malicious links  
- Phishing emails redirecting the user to crafted pages  
- Using XSS to automatically trigger requests from the authenticated client
</div>

<div class="card">
<h2>3. Vulnerability from a Defender Perspective:</h2>
- Servers must not trust requests solely because they carry valid authentication cookies.  
- Every state-changing request should include a mechanism to verify the legitimacy of the request (e.g., CSRF tokens).  
- Use cookie attributes like SameSite to restrict automatic cookie sending.
</div>

<div class="card">
<h2>3.1 Solutions for a Defender:</h2>
1. <b>Cookie-based mitigations:</b>  
- SameSite=Strict: Cookies sent only for same-origin requests.  
- SameSite=Lax: Cookies sent for top-level navigations, not embedded requests.  
- SameSite=None: Cookies sent for all requests but must be Secure (HTTPS).  

2. <b>CSRF Tokens:</b>  
- Unique, unpredictable token issued per session or request.  
- Sent via hidden HTML form fields or AJAX headers (e.g., X-CSRF-Token).  
- Server verifies token matches session-stored value.  
- Tokens expire and ensure only legitimate requests are accepted.
</div>

<div class="card">
<h2>4. Extras:</h2>
- CSRF is a trust-based attack: the server trusts the client.  
- Effective mitigation combines SameSite cookies, CSRF tokens, and user interaction verification.  
- Monitoring unexpected state-changing requests can help detect attempted attacks.
</div>

</body>
</html>
