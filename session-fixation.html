<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Session Fixation</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f4f4f9;
      margin: 0;
      padding: 20px;
    }
    h1 {
      text-align: center;
      margin-bottom: 20px;
    }
    h2 {
      color: #ef5350;
    }
    section {
      margin-bottom: 20px;
    }
    pre {
      background: #f9f9f9;
      padding: 10px;
      border-left: 4px solid #4CAF50;
      overflow-x: auto;
    }
    ul {
      margin-left: 20px;
    }
    ol {
      margin-left: 20px;
    }
  </style>
</head>
<body>
  <h1>Session Fixation</h1>

  <section>
    <h2>1. Overview</h2>
    <p>
      A session refers to the communication lifecycle between a client (browser) and a server.
      The server creates a session ID and sends it to the browser (often via a cookie) to track
      and identify the session in subsequent requests.
    </p>
    <pre>Set-Cookie: JSESSIONID=xyz123; Secure; HttpOnly; SameSite=Strict</pre>
    <p>
      Proper session management requires unique, unpredictable session IDs that are renewed after
      authentication. Cookies should be secured using Secure, HttpOnly, and SameSite attributes.
    </p>
  </section>

  <section>
    <h2>2. Vulnerability from an attacker perspective</h2>
    <p>
      Session Fixation occurs when an attacker can force a victim to use a known session ID, allowing
      the attacker to hijack the authenticated session.
    </p>

    <h3>2.1 Attempts of an attacker</h3>
    <ol>
      <li>Attacker obtains a valid session ID from the target app (pre-login).</li>
      <li>Attacker forces victim to use that session ID via URL, link, or cookie injection.</li>
      <li>Victim logs in, and the application keeps the same session ID.</li>
      <li>Attacker reuses the same session ID to hijack the authenticated session.</li>
    </ol>
  </section>

  <section>
    <h2>3. Vulnerability from a defender perspective</h2>
    <p>
      Applications that do not generate a new session ID upon authentication are vulnerable.
      Sessions that are not properly invalidated on logout or use predictable IDs are also at risk.
    </p>

    <h3>3.1 Solutions of a defender</h3>
    <ul>
      <li>Generate a new, unique session ID immediately after successful authentication.</li>
      <li>Use secure, HttpOnly, and SameSite attributes for session cookies.</li>
      <li>Implement proper session timeout and renewal policies.</li>
      <li>Ensure logout destroys the session completely, preventing reuse.</li>
      <li>Avoid exposing session IDs in URLs.</li>
    </ul>
  </section>

  <section>
    <h2>4. Extras</h2>
    <ul>
      <li>Testing: Capture pre-login session ID and compare with post-login ID to detect vulnerability.</li>
      <li>Mitigations are standard in most modern web frameworks (session regeneration, secure cookies).</li>
    </ul>
  </section>
</body>
</html>
