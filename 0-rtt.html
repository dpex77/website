<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>TLS 1.3 Scanner - 0-RTT</title>
  <style>
    body {
      font-family: Consolas, monospace;
      background: #f4f4f9;
      margin: 0;
      padding: 20px;
      line-height: 1.5;
    }
    h1 {
      text-align: center;
      margin-bottom: 20px;
    }
    pre {
      background: #1e1e1e;
      color: #d4d4d4;
      padding: 20px;
      border-radius: 8px;
      overflow-x: auto;
      white-space: pre-wrap;
      word-wrap: break-word;
    }
    .section {
      margin-bottom: 40px;
    }
    .back {
      display: block;
      margin-top: 20px;
      text-align: center;
    }
    a {
      color: #007BFF;
      text-decoration: none;
    }
    a:hover {
      text-decoration: underline;
    }
  </style>
</head>
<body>
  <h1>TLS 1.3 Scanner for 0-RTT</h1>

  <div class="section">
    <h2>Python Script</h2>
    <pre>
#!/usr/bin/env python3

import socket
import argparse
from OpenSSL import SSL

def scan_tls13(host, port=443):
    print(f"[+] Starting TLS 1.3 scan on {host}:{port}")

    # TLS 1.3 context
    ctx = SSL.Context(SSL.TLS_CLIENT_METHOD)
    ctx.set_options(SSL.OP_NO_TLSv1 | SSL.OP_NO_TLSv1_1 | SSL.OP_NO_TLSv1_2)
    ctx.set_verify(SSL.VERIFY_NONE, lambda conn, cert, errno, depth, ok: ok)

    # First handshake: get session ticket
    sock1 = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    conn1 = SSL.Connection(ctx, sock1)
    conn1.set_tlsext_host_name(host.encode())
    conn1.connect((host, port))
    conn1.do_handshake()

    session = conn1.get_session()
    print("[*] TLS version:", conn1.get_protocol_version_name())
    print("[*] Negotiated cipher:", conn1.get_cipher_name())
    print("[*] Session ticket obtained:", session is not None)

    alpn_proto = conn1.get_alpn_proto_negotiated()
    print("[*] ALPN protocol negotiated:", alpn_proto.decode() if alpn_proto else "None")

    cert_sig_alg = conn1.get_peer_certificate().get_signature_algorithm()
    print("[*] Certificate signature algorithm:", cert_sig_alg.decode())
    print("[*] Compression enabled: False (TLS 1.3 disables compression)")
    print("[*] Renegotiation allowed: False (TLS 1.3 disallows renegotiation)")

    conn1.shutdown()
    conn1.close()

    # 0-RTT early data attempt
    sock2 = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    conn2 = SSL.Connection(ctx, sock2)
    conn2.set_tlsext_host_name(host.encode())
    conn2.set_session(session)
    conn2.connect((host, port))

    early_data = b"GET / HTTP/1.1\r\nHost: %b\r\n\r\n" % host.encode()
    try:
        sent_bytes = conn2.send(early_data)
        print("[*] Early data sent: %d bytes (attempting 0-RTT)" % sent_bytes)
    except SSL.WantWriteError:
        print("[!] Early data not accepted immediately")

    try:
        data_early = conn2.recv(4096)
        if data_early:
            print("[*] 0-RTT accepted! Server responded before handshake completed.")
            print("[*] Server response (truncated):", data_early[:200])
    except SSL.ZeroReturnError:
        print("[*] No early response yet â€” 0-RTT may not be accepted")

    conn2.do_handshake()
    print("[*] Second handshake TLS version:", conn2.get_protocol_version_name())
    print("[*] Negotiated cipher:", conn2.get_cipher_name())

    alpn_proto2 = conn2.get_alpn_proto_negotiated()
    print("[*] ALPN protocol negotiated:", alpn_proto2.decode() if alpn_proto2 else "None")

    new_session = conn2.get_session()
    session_resumed = (new_session == session)
    print("[*] Session resumed:", session_resumed)

    conn2.shutdown()
    conn2.close()

    print("\n[+] TLS 1.3 scan complete")

if __name__ == "__main__":
    parser = argparse.ArgumentParser(description="TLS 1.3 Feature Scanner")
    parser.add_argument("host", help="Target IP or hostname")
    parser.add_argument("-p", "--port", type=int, default=443, help="Target port (default 443)")
    args = parser.parse_args()
    scan_tls13(args.host, args.port)
    </pre>
  </div>

  <div class="section">
    <h2>Example Output</h2>
    <pre>
python3 9.py 192.168.209.130
[+] Starting TLS 1.3 scan on 192.168.209.130:443
[*] TLS version: TLSv1.3
[*] Negotiated cipher: TLS_AES_128_GCM_SHA256
[*] Session ticket obtained: True
[*] ALPN protocol negotiated: None
[*] Certificate signature algorithm: sha256WithRSAEncryption
[*] Compression enabled: False (TLS 1.3 disables compression)
[*] Renegotiation allowed: False (TLS 1.3 disallows renegotiation)
[*] Early data sent: 41 bytes (attempting 0-RTT)
[*] 0-RTT accepted! Server responded before handshake completed.
[*] Server response (truncated): b'HTTP/1.1 200 OK\r\nCache-Control: public, max-age=3600\r\nContent-Length: 1024\r\nContent-Type: text/html\r\nLast-Modified: Tue, 23 Apr 2024 13:26:51 GMT\r\nDate: Sat, 06 Sep 2025 00:27:22 GMT\r\nConnection: keep'
[*] Second handshake TLS version: TLSv1.3
[*] Negotiated cipher: TLS_AES_128_GCM_SHA256
[*] ALPN protocol negotiated: None
[*] Session resumed: False

[+] TLS 1.3 scan complete
    </pre>
  </div>

  <div class="back">
    <a href="index.html">&larr; Back to Security Overview</a>
  </div>
</body>
</html>
